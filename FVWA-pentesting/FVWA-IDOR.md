## [ЗАДАНИЕ 8 - IDOR]

**IDOR (Insecure Direct Object Reference)** — это уязвимость, в которой приложение не надлежащим образом проверяет аутентификацию и авторизацию пользователей при доступе к объектам или ресурсам.

Уязвимость IDOR возникает, когда приложение использует прямые ссылки на внутренние объекты или ресурсы без проверки, имеет ли пользователь право на их доступ. Это может создать возможность для злоумышленников получить незаконный доступ к защищенным данным или функциональности.

Примером может быть веб-приложение для онлайн-магазина, где каждый продукт имеет свой уникальный идентификатор (ID). Злоумышленник может изменить этот ID в URL и попытаться получить доступ к продукту, на который у него нет прав. Если приложение не проверяет авторизацию при доступе к объекту по этому ID, злоумышленник сможет просмотреть защищенные данные о продукте, либо даже добавить его в корзину или осуществить покупку от имени другого пользователя.
Одним из примеров уязвимости IDOR была известная уязвимость в социальной сети Facebook в 2007 году. В этом случае, через прямые запросы к API, злоумышленники могли получить доступ к альбомам и фотографиям других пользователей, даже если они были установлены как приватные.

Давайте теперь рассмотрим одну из вариаций такой уязвимости и найдём скрытую комнату на примере нашей лабораторной.

Переходим на страницу /corridor, где нас встречают 5 комнат. 
На этом этапе, посетив каждую из пяти комнат, нас может насторожить URL, по которому мы переходим в ту или иную комнату:
```
/corridor/c4ca4238a0b923820dcc509a6f75849b — Room 1
/corridor/c81e728d9d4c2f636f067f89cc14862c — Room 2
/corridor/eccbc87e4b5ce2fe28308fd9f2a7baf3 — Room 3
/corridor/a87ff679a2f3e71d9181a67b7542122c — Room 4
/corridor/e4da3b7fbbce2345d7772b0674a318d5 — Room 5
```
На первый взгляд кажется, что эти пути сгенерированы случайно, и найти скрытую комнату можно разве что перебором. Однако на самом деле это ни что иное, как MD5 хэши. Попробуем понять, что таким образом было кэшировано. Для этого используем онлайн инструмент Crackstation, содержащий огромную базу хэшей и первообразных к ним.
И тут мы сразу же понимаем принцип генерации URL комнат.

Нетрудно догадаться, что теперь нам нужно посетить комнату либо с номером 6, либо с номером 0. Зная правильный ответ, сразу скажу, что нас интересует именно 0.

Пользуемся любой утилитой по вычислению хэша (будь то встроенные утилиты Linux, онлайн тулзы типа CyberChef и т.п.) и получаем хэш от нуля:
md5(0) -> cfcd208495d565ef66e7dff9f98764da

Осталось лишь перейти по полученному URI и забрать флаг:
/corridor/cfcd208495d565ef66e7dff9f98764da — Room 0
